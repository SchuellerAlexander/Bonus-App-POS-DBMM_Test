<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{admin-layout :: layout('Admin Ledger', ~{::section})}">
<section class="space-y-8">
    <div class="card p-6 reveal">
        <div class="text-sm uppercase tracking-[0.2em] text-ink/60">Punkte &amp; Ledger</div>
        <div class="font-display text-2xl">Point Ledger</div>
        <p class="mt-2 text-sm text-ink/60">Manuelle Korrekturen werden mit Zeitstempel und Begründung gespeichert.</p>
        <div class="mt-4 text-sm text-red-700" th:if="${errorMessage != null}" th:text="${errorMessage}">Error</div>
    </div>

    <div class="card p-6 reveal">
        <div class="font-display text-xl">Punkte manuell anpassen</div>
        <form class="mt-4 grid gap-4 md:grid-cols-4" action="/admin/ledger/adjust" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <input class="input" name="accountId" placeholder="Account ID" type="number" required>
            <input class="input" name="pointsDelta" placeholder="+/- Punkte" type="number" required>
            <input class="input md:col-span-2" name="reason" placeholder="Begründung" required>
            <div class="md:col-span-4">
                <button class="btn-primary" type="submit">Buchen</button>
            </div>
        </form>
    </div>

    <div class="card p-6 reveal overflow-auto">
        <table class="min-w-full text-sm">
            <thead>
            <tr class="text-left text-ink/60 uppercase text-xs tracking-[0.2em]">
                <th class="py-2 pr-4">Zeitpunkt</th>
                <th class="py-2 pr-4">Kunde</th>
                <th class="py-2 pr-4">Account</th>
                <th class="py-2 pr-4">Typ</th>
                <th class="py-2 pr-4">Punkte</th>
                <th class="py-2 pr-4">Saldo</th>
                <th class="py-2 pr-4">Beschreibung</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="entry : ${entries}" class="border-t border-ink/10">
                <td class="py-3 pr-4" th:text="${entry.occurredAt}">-</td>
                <td class="py-3 pr-4" th:text="${entry.loyaltyAccount.customer.firstName + ' ' + entry.loyaltyAccount.customer.lastName}">-</td>
                <td class="py-3 pr-4" th:text="${entry.loyaltyAccount.accountNumber}">-</td>
                <td class="py-3 pr-4" th:text="${entry.entryType}">-</td>
                <td class="py-3 pr-4" th:text="${entry.points}">0</td>
                <td class="py-3 pr-4" th:text="${entry.balanceAfter}">0</td>
                <td class="py-3 pr-4" th:text="${entry.description}">-</td>
            </tr>
            </tbody>
        </table>
    </div>
</section>
</html>
