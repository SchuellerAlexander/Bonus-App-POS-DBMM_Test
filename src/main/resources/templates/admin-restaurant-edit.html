<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{admin-layout :: layout('Edit Restaurant', ~{::section})}">
<section class="space-y-8">
    <div class="card p-6 reveal space-y-4">
        <div class="flex flex-col gap-2">
            <div class="text-sm uppercase tracking-[0.2em] text-ink/60">Restaurant Details</div>
            <div class="font-display text-2xl" th:text="${restaurant.name}">Restaurant</div>
            <a class="text-sm text-ink/60 underline" href="/admin/restaurants">‚Üê Zur√ºck zur √úbersicht</a>
        </div>

        <form th:action="@{/admin/restaurants/{id}/update(id=${restaurant.id})}"
              method="post" class="grid gap-4 md:grid-cols-4">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <input class="input" name="name" th:value="${restaurant.name}" required>
            <input class="input" name="code" th:value="${restaurant.code}" required>
            <input class="input" name="defaultCurrency" th:value="${restaurant.defaultCurrency}" required>
            <label class="text-sm text-ink/60 flex items-center gap-2">
                <input type="checkbox" name="active" th:checked="${restaurant.active}">
                Aktiv
            </label>
            <button class="btn-primary" type="submit">Restaurant speichern</button>
        </form>
    </div>

    <div class="card p-6 reveal space-y-4">
        <div>
            <div class="text-sm uppercase tracking-[0.2em] text-ink/60">Punktelogik</div>
            <div class="font-display text-xl">Punkte pro Euro</div>
        </div>
        <form action="/admin/points-rules/set" method="post" class="grid gap-4 md:grid-cols-4">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <input type="hidden" name="restaurantId" th:value="${restaurant.id}">
            <input class="input" name="pointsPerEuro" type="number" min="0" step="0.01"
                   th:value="${pointRule != null ? pointRule.multiplier : 1}">
            <label class="text-sm text-ink/60 flex items-center gap-2">
                <input type="checkbox" name="active"
                       th:checked="${pointRule != null ? pointRule.active : true}">
                Regel aktiv
            </label>
            <button class="btn-secondary" type="submit">Regel speichern</button>
        </form>
    </div>

    <div class="card p-6 reveal space-y-6">
        <div>
            <div class="text-sm uppercase tracking-[0.2em] text-ink/60">Rewards</div>
            <div class="font-display text-xl">Rewards verwalten</div>
        </div>

        <div th:if="${#lists.isEmpty(rewards)}" class="text-sm text-ink/60">
            Keine Rewards vorhanden.
        </div>

        <div th:each="reward : ${rewards}" class="card p-4 border border-ink/10 space-y-3">
            <form th:action="@{/admin/rewards/{id}/update(id=${reward.id})}" method="post"
                  class="grid gap-3 md:grid-cols-6 md:items-end">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <input type="hidden" name="restaurantId" th:value="${restaurant.id}">
                <div>
                    <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Code</label>
                    <input class="input" name="rewardCode" th:value="${reward.rewardCode}">
                </div>
                <div>
                    <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Name</label>
                    <input class="input" name="name" th:value="${reward.name}">
                </div>
                <div>
                    <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Beschreibung</label>
                    <input class="input" name="description" th:value="${reward.description}">
                </div>
                <div>
                    <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Punkte</label>
                    <input class="input" name="costPoints" type="number" min="1" th:value="${reward.costPoints}">
                </div>
                <div>
                    <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Typ</label>
                    <select class="input" name="rewardType">
                        <option th:each="type : ${rewardTypes}"
                                th:value="${type}"
                                th:selected="${type == reward.rewardType}"
                                th:text="${type}">Type</option>
                    </select>
                </div>
                <label class="text-sm text-ink/60 flex items-center gap-2">
                    <input type="checkbox" name="active" th:checked="${reward.active}">
                    Aktiv
                </label>
                <button class="btn-primary" type="submit">Speichern</button>
            </form>
            <form th:action="@{/admin/rewards/{id}/delete(id=${reward.id})}" method="post" class="text-right">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <input type="hidden" name="restaurantId" th:value="${restaurant.id}">
                <button class="btn-secondary" type="submit">üóëÔ∏è Reward l√∂schen</button>
            </form>
        </div>

        <form th:action="@{/admin/restaurants/{id}/rewards/create(id=${restaurant.id})}"
              method="post" class="grid gap-3 md:grid-cols-6 md:items-end">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
            <input type="hidden" name="restaurantId" th:value="${restaurant.id}">
            <div>
                <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Code</label>
                <input class="input" name="rewardCode" placeholder="REWARD-01" required>
            </div>
            <div>
                <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Name</label>
                <input class="input" name="name" placeholder="Getr√§nk" required>
            </div>
            <div>
                <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Beschreibung</label>
                <input class="input" name="description" placeholder="Beschreibung">
            </div>
            <div>
                <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Punkte</label>
                <input class="input" name="costPoints" type="number" min="1" value="50" required>
            </div>
            <div>
                <label class="text-xs uppercase tracking-[0.2em] text-ink/60">Typ</label>
                <select class="input" name="rewardType">
                    <option th:each="type : ${rewardTypes}" th:value="${type}" th:text="${type}">Type</option>
                </select>
            </div>
            <label class="text-sm text-ink/60 flex items-center gap-2">
                <input type="checkbox" name="active" checked>
                Aktiv
            </label>
            <button class="btn-secondary" type="submit">Reward anlegen</button>
        </form>
    </div>
</section>
</html>
